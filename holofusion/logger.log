INFO:sqlalchemy.engine.base.Engine:SHOW VARIABLES LIKE 'sql_mode'
INFO:sqlalchemy.engine.base.Engine:()
INFO:sqlalchemy.engine.base.Engine:SELECT DATABASE()
INFO:sqlalchemy.engine.base.Engine:()
INFO:sqlalchemy.engine.base.Engine:show collation where `Charset` = 'utf8' and `Collation` = 'utf8_bin'
INFO:sqlalchemy.engine.base.Engine:()
INFO:sqlalchemy.engine.base.Engine:SELECT CAST('test plain returns' AS CHAR(60)) AS anon_1
INFO:sqlalchemy.engine.base.Engine:()
INFO:sqlalchemy.engine.base.Engine:SELECT CAST('test unicode returns' AS CHAR(60)) AS anon_1
INFO:sqlalchemy.engine.base.Engine:()
INFO:sqlalchemy.engine.base.Engine:SELECT CAST('test collated returns' AS CHAR CHARACTER SET utf8) COLLATE utf8_bin AS anon_1
INFO:sqlalchemy.engine.base.Engine:()
INFO:__main__:Connection established to data database
INFO:__main__:ingesting file:data/stock-data/stock-data-test.csv
INFO:sqlalchemy.engine.base.Engine:INSERT INTO metatable (dataset_id,tablename,schem) VALUES('70293646438','Init','index,source,date_symbol,percent_change,last');
INFO:sqlalchemy.engine.base.Engine:()
INFO:sqlalchemy.engine.base.Engine:COMMIT
INFO:__main__:creating dataset with id:70293646438
INFO:sqlalchemy.engine.base.Engine:SELECT schem FROM metatable Where dataset_id = '70293646438' AND  tablename = 'Init';
INFO:sqlalchemy.engine.base.Engine:()
INFO:sqlalchemy.engine.base.Engine:INSERT INTO metatable (dataset_id,tablename,schem) VALUES('70293646438','Training','date_symbol,percent_change,last');
INFO:sqlalchemy.engine.base.Engine:()
INFO:sqlalchemy.engine.base.Engine:COMMIT
INFO:sqlalchemy.engine.base.Engine:CREATE TABLE 70293646438_C_clean AS (SELECT table1.* FROM 70293646438_Init AS table1, 70293646438_Training AS table2 WHERE table1.date_symbol=table2.date_symbol and table1.percent_change=table2.percent_change);
INFO:sqlalchemy.engine.base.Engine:()
INFO:sqlalchemy.engine.base.Engine:COMMIT
INFO:sqlalchemy.engine.base.Engine:CREATE TABLE 70293646438_C_dk AS (SELECT table1.* FROM 70293646438_Init AS table1 LEFT JOIN 70293646438_Training AS table2 on table1.date_symbol=table2.date_symbol where table2.date_symbol is NULL);
INFO:sqlalchemy.engine.base.Engine:()
INFO:sqlalchemy.engine.base.Engine:COMMIT
INFO:sqlalchemy.engine.base.Engine:SELECT schem FROM metatable Where dataset_id = '70293646438' AND  tablename = 'Init';
INFO:sqlalchemy.engine.base.Engine:()
INFO:sqlalchemy.engine.base.Engine:SELECT schem FROM metatable Where dataset_id = '70293646438' AND  tablename = 'Init';
INFO:sqlalchemy.engine.base.Engine:()
INFO:sqlalchemy.engine.base.Engine:set @p:=0;
INFO:sqlalchemy.engine.base.Engine:()
INFO:sqlalchemy.engine.base.Engine:CREATE TABLE             70293646438_Feature_temp(var_index INT,Source_id TEXT, key_id TEXT,             attribute TEXT, source_observation TEXT, weight_id TEXT, fixed INT);
INFO:sqlalchemy.engine.base.Engine:()
INFO:sqlalchemy.engine.base.Engine:COMMIT
INFO:sqlalchemy.engine.base.Engine:INSERT INTO 70293646438_Feature_temp SELECT * FROM (  (SELECT  @p := @p + 1 AS var_index,                                                    Source AS Source_id,		                                            init.date_symbol as key_id,'percent_change'                                                      AS attribute, 		                                            init.percent_change AS source_observation ,                                                    ' 'AS weight_id, 1 AS fixed                                                    FROM 70293646438_C_clean AS init where init.percent_change IS NOT NULL)as T_0);
INFO:sqlalchemy.engine.base.Engine:()
INFO:sqlalchemy.engine.base.Engine:COMMIT
INFO:sqlalchemy.engine.base.Engine:select max(var_index) into @p from 70293646438_Feature_temp;
INFO:sqlalchemy.engine.base.Engine:()
INFO:sqlalchemy.engine.base.Engine:INSERT INTO 70293646438_Feature_temp SELECT * FROM (  (SELECT  @p := @p + 1 AS var_index,                                                 Source AS Source_id,		                                         init.date_symbol as key_id,'percent_change'                                                   AS attribute, 		                                         init.percent_change AS source_observation ,                                                 ' 'AS weight_id, 0 AS fixed                                                 FROM 70293646438_C_dk AS init where init.percent_change IS NOT NULL)as T_1);
INFO:sqlalchemy.engine.base.Engine:()
INFO:sqlalchemy.engine.base.Engine:COMMIT
INFO:sqlalchemy.engine.base.Engine:select max(var_index) into @p from 70293646438_Feature_temp;
INFO:sqlalchemy.engine.base.Engine:()
INFO:__main__:adding weight_id to feature table...
INFO:sqlalchemy.engine.base.Engine:CREATE TABLE 70293646438_weight_temp(weight_id INT PRIMARY KEY AUTO_INCREMENT,Source_id LONGTEXT);
INFO:sqlalchemy.engine.base.Engine:()
INFO:sqlalchemy.engine.base.Engine:COMMIT
INFO:sqlalchemy.engine.base.Engine:INSERT INTO  70293646438_weight_temp (SELECT * FROM (SELECT distinct NULL, Source_id FROM 70293646438_Feature_temp) AS TABLE1);
INFO:sqlalchemy.engine.base.Engine:()
INFO:sqlalchemy.engine.base.Engine:COMMIT
INFO:sqlalchemy.engine.base.Engine:CREATE TABLE                                      70293646438_Feature(var_index INT PRIMARY KEY AUTO_INCREMENT,Source_id TEXT , rv_index TEXT,	                                   rv_attr TEXT,assigned_val   TEXT, weight_id TEXT, fixed INT );
INFO:sqlalchemy.engine.base.Engine:()
INFO:sqlalchemy.engine.base.Engine:COMMIT
INFO:sqlalchemy.engine.base.Engine:INSERT INTO 70293646438_Feature (SELECT * FROM ( SELECT NULL AS var_index , table1.Source_id , table1.key_id as rv_index, table1.attribute as rv_attr , table1.source_observation as assigned_val ,  table2.weight_id, table1.fixed as fixed FROM 70293646438_Feature_temp AS table1, 70293646438_weight_temp AS table2  WHERE table1.Source_id=table2.Source_id ) AS ftmp  order by rv_index,rv_attr );
INFO:sqlalchemy.engine.base.Engine:()
